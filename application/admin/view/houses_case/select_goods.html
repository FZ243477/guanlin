<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>{:getSetting('system.title')} </title>

	<link href="home_url/css/bootstrap.min.css" rel="stylesheet">
	<link href="home_url/css/font-awesome.css-v=4.4.0.css" rel="stylesheet">
	<link href="home_url/css/plugins/iCheck/custom.css" rel="stylesheet">
	<link href="home_url/css/style.min.css" rel="stylesheet">

	<style>
		.banner_myupload  {
			opacity: 0;
			display:none;
		}
		td {
			height: 80px;
		}
	</style>
</head>

{include file="Base:base" /}
<body class="gray-bg">
<div class="wrapper wrapper-content animated fadeInRight">
	<div class="row">
		<div class="col-sm-12">
			<div class="ibox">
				<div class="tabs-container">

					<div class="tab-content">
						<div id="tab-1" class="tab-pane active">
							<div class="panel-body">

								<div class="ibox-content-del">

									<div class="row">
										<form method="get" action="" class="form-inline">
											<div class="input-group">
												<select class=" form-control" name="cate_id" >
													<option value="" style="width:70%;">-请选择分类-</option>
													{foreach name="goods_cate" item="vo"}
													<option value="{$vo.id}" {eq name="cate_id" value="$vo.id"}selected{/eq} style="width:100%;background-color: #EAC06C" >
													{$vo.name}
													</option>
													{foreach name="vo.cate" item="vv"}
													<option  value="{$vv.id}"  {eq name="cate_id" value="$vv.id"}selected{/eq} style="width:70%;">{$vv.name}</option>
													{/foreach}
													{/foreach}
												</select>
											</div>
											<div class="input-group">
												<input type="text" name="keyword" placeholder="名称" class=" form-control" value="{$keyword}" style="width:130px">
												<span class="input-group-btn">
												<button type="submit" class="btn btn-sm btn-primary"> 搜索</button> </span>
											</div>
										</form>
									</div>

									<div class="table-responsive">
										<table class="table table-hover products_table">
											<colgroup>
												<col width="5%">
												<col width="10%">
												<col width="10%">
												<col width="10%">
												<col width="10%">
												<col width="10%">
												<col width="10%">
												<col width="10%">
												<col width="10%">

											</colgroup>
											<thead>
											<tr >
												<th></th>
												<th>ID</th>
												<th>名称</th>
												<th>图片</th>
												<th>一级分类</th>
												<th>二级分类</th>
												<th>图片</th>
												<th>价格</th>
												<th>原价</th>
											</tr>
											</thead>
											<tbody>
											{foreach name="list" item="vo"}
											<tr onclick="select_design(this)">
												<td>
													<input type="checkbox" class="i-checks checkbox" name="input" value="{$vo.id}"
														   data-goods_name="{$vo.goods_name}"
														   data-cate_id="{$vo.cate_id}"
														   data-goods_logo ="{$vo.goods_logo}"
														   data-goods_price="{$vo.goods_price}"
														   data-goods_oprice="{$vo.goods_oprice}"
													>
												</td>
												<td>{$vo.id}</td>
												<td>{$vo.goods_name}</td>
												<td><img src="{$vo.goods_logo}" width="100"/></td>
												<td>{$goods_pid_array[$vo['pid']]}</td>
												<td>{$goods_cate_array[$vo['cate_id']]}</td>
												<td>{$vo.goods_price}</td>
												<td>{$vo.goods_oprice}</td>
											</tr>
											{/foreach}
											{empty name="list"}
											<tr><td style='text-align:center' colspan='10'>暂无数据</td></tr>
											{/empty}
											<tr>
												<td colspan="12" class="pro_lasttd">
													<label ><input type="checkbox" class="i-checks all"  name="inputs"><span>全选</span></label>
													<div class="pro_table_contro">
														<a href="javascript:void(0);" class="btn btn-primary btn-sm sure_select" >确定选择</a>
													</div>
												</td>
											</tr>
											</tbody>
										</table>

										<div class="text-center">
											<div class="page">
												{$list->render()}
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>
</div>
<script src="home_url/js/jquery.min.js"></script>
<script src="home_url/js/bootstrap.min.js"></script>
<script src="home_url/js/plugins/peity/jquery.peity.min.js"></script>
<script src="home_url/js/content.min.js"></script>
<script src="home_url/js/plugins/iCheck/icheck.min.js"></script>
<script src="home_url/js/peity-demo.min.js"></script>
<script src="home_url/js/plugins/layer/laydate/laydate.js"></script>
<script type="text/javascript">
    $('.sure_select').click(function () {
        var goods_info = '';
        $(".checkbox").each(function(){
            if($(this).is(':checked')){
                var goods_id = $(this).val();
                var goods_name = $(this).attr('data-goods_name');
                var goods_logo = $(this).attr('data-goods_logo');
                var goods_price = $(this).attr('data-goods_price');
                var cate_id = $(this).attr('data-cate_id');
                var goods_oprice = $(this).attr('data-goods_oprice');
                goods_info += '<li data-goods_id="'+goods_id+'">' +
                    '<div class="row">'+
                    '<div class="col-sm-1 m_goods_logo">' + '<img src="' + goods_logo +'" width="50">' + '</div>' +
                    '<div class="col-sm-4 m_goods_name">'+ goods_name +  '</div>'+
                    ' <div class="col-sm-2 m_goods_price" data-goods_price="'+goods_price+'">价格：' + goods_price + '</div>' +
                    ' <div class="col-sm-3 m_goods_num">数量:' +
					'<input class="input mini" name="m_goods_num[]" value="1"/>' +
					'<input type="hidden" name="m_goods_id[]" value="'+goods_id+'"/>' +
					'<input type="hidden" name="m_cate_id[]" value="'+cate_id+'"/>' +
					'</div>' +
                    '<em class="close col-sm-1" title="移除这件商品？" onclick="delGoods(this)">×</em>' +
                    '</div></li>';
            }
        });
        if (goods_info == '') {
            alert('请选择商品');
            return false;
        }
        // console.log(goods_info);
        javascript:window.parent.goods_call_back(goods_info)
    });

    function  select_design(obj) {
        if ($(obj).find('.checkbox').is(':checked')) {
            $(obj).find('.checkbox').prop('checked', false);
        } else {
            $(obj).find('.checkbox').prop('checked', true);
        }
        var i = 1;
        $(".checkbox").each(function(){
            if(true != $(this).is(':checked')){
                i = 0;
            }
        });
        // console.log(i);
        if (i == 1) {
            $('td.pro_lasttd input').prop('checked', true);
        } else {
            $('td.pro_lasttd input').prop('checked', false);
        }
    }
</script>

<script>
    $(document).ready(function () {
        // $(".i-checks").iCheck({checkboxClass: "icheckbox_square-green", radioClass: "iradio_square-green",})
        $(".checkbox").on('click', function (event) {
            if ($(this).is(':checked')) {
                $(this).prop('checked', false);
            } else {
                $(this).prop('checked', true);
            }
            var i = 1;
            $(".checkbox").each(function(){
                if(true != $(this).is(':checked')){
                    i = 0;
                }
            });
            if (i == 1) {
                $('td.pro_lasttd input').prop('checked', true);
            } else {
                $('td.pro_lasttd input').prop('checked', false);
            }
        });
        $('td.pro_lasttd input').on('click', function(event){
            if(true == $(this).is(':checked')){
                $('.checkbox').prop('checked', true);
            } else {
                $('.checkbox').prop('checked', false);
            }
        });
    });

    $("li").click(function(){
        $a=$(this).find("a").attr("href");
        // alert($a);
        if ($a) { window.location=$a; }
    })
</script>

</body>

</html>
